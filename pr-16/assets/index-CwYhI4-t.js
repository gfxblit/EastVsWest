(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();const s={GAME:{INITIAL_ZONE_SHRINK_DELAY_SECONDS:60},CANVAS:{WIDTH:1200,HEIGHT:800,BACKGROUND_COLOR:"#2a2a2a"},PLAYER:{BASE_MOVEMENT_SPEED:200,DOUBLE_HANDED_SPEED_MODIFIER:.85},ZONE:{INITIAL_RADIUS:600,MIN_RADIUS:50,BASE_SHRINK_RATE:10,SHRINK_RATE_MULTIPLIER:1.5,DAMAGE_PER_SECOND:10,DAMAGE_INCREASE_PER_PHASE:5},RENDER:{PLAYER_RADIUS:20,HEALTH_BAR_WIDTH:40,HEALTH_BAR_HEIGHT:5,HEALTH_BAR_OFFSET_Y:30},INPUT:{KEYBOARD_MOVE_KEYS:{w:{x:0,y:-1},a:{x:-1,y:0},s:{x:0,y:1},d:{x:1,y:0}},SPECIAL_ABILITY_KEY:"q",INTERACT_KEY:"f"}};class l{constructor(){this.state={players:[],conflictZone:{centerX:s.CANVAS.WIDTH/2,centerY:s.CANVAS.HEIGHT/2,radius:s.ZONE.INITIAL_RADIUS},loot:[],gameTime:0,phase:0,isRunning:!1}}init(){console.log("Game initialized"),this.state.isRunning=!0,this.state.players.push({id:"player-1",x:s.CANVAS.WIDTH/2,y:s.CANVAS.HEIGHT/2,health:100,weapon:null,armor:null,velocity:{x:0,y:0}})}update(e){this.state.isRunning&&(this.state.gameTime+=e,this.updateConflictZone(e),this.updatePlayers(e))}updateConflictZone(e){if(this.state.gameTime>s.GAME.INITIAL_ZONE_SHRINK_DELAY_SECONDS){const t=s.ZONE.BASE_SHRINK_RATE*Math.pow(s.ZONE.SHRINK_RATE_MULTIPLIER,this.state.phase);this.state.conflictZone.radius=Math.max(s.ZONE.MIN_RADIUS,this.state.conflictZone.radius-t*e)}}updatePlayers(e){for(const t of this.state.players)if(t.x+=t.velocity.x*e,t.y+=t.velocity.y*e,t.x=Math.max(0,Math.min(s.CANVAS.WIDTH,t.x)),t.y=Math.max(0,Math.min(s.CANVAS.HEIGHT,t.y)),Math.sqrt(Math.pow(t.x-this.state.conflictZone.centerX,2)+Math.pow(t.y-this.state.conflictZone.centerY,2))>this.state.conflictZone.radius){const n=(s.ZONE.DAMAGE_PER_SECOND+s.ZONE.DAMAGE_INCREASE_PER_PHASE*this.state.phase)*e;t.health=Math.max(0,t.health-n)}}handleInput(e){var o;const t=this.state.players[0];if(!t)return;const i=((o=t.weapon)==null?void 0:o.stance)==="double"?s.PLAYER.DOUBLE_HANDED_SPEED_MODIFIER:1,n=s.PLAYER.BASE_MOVEMENT_SPEED*i;t.velocity={x:e.moveX*n,y:e.moveY*n}}getState(){return this.state}}class h{constructor(e){this.canvas=e,this.ctx=null}init(){if(this.ctx=this.canvas.getContext("2d"),!this.ctx){console.error("Failed to get 2D context from canvas");return}this.canvas.width=s.CANVAS.WIDTH,this.canvas.height=s.CANVAS.HEIGHT,console.log("Renderer initialized")}render(e){if(this.ctx){this.ctx.fillStyle=s.CANVAS.BACKGROUND_COLOR,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.renderConflictZone(e.conflictZone);for(const t of e.players)this.renderPlayer(t);for(const t of e.loot)this.renderLoot(t)}}renderConflictZone(e){this.ctx.strokeStyle="#ff6b6b",this.ctx.lineWidth=3,this.ctx.beginPath(),this.ctx.arc(e.centerX,e.centerY,e.radius,0,Math.PI*2),this.ctx.stroke(),this.ctx.fillStyle="rgba(255, 107, 107, 0.2)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.globalCompositeOperation="destination-out",this.ctx.beginPath(),this.ctx.arc(e.centerX,e.centerY,e.radius,0,Math.PI*2),this.ctx.fill(),this.ctx.globalCompositeOperation="source-over"}renderPlayer(e){this.ctx.fillStyle="#4ecdc4",this.ctx.beginPath(),this.ctx.arc(e.x,e.y,s.RENDER.PLAYER_RADIUS,0,Math.PI*2),this.ctx.fill();const t=s.RENDER.HEALTH_BAR_WIDTH,i=s.RENDER.HEALTH_BAR_HEIGHT,n=e.x-t/2,o=e.y-s.RENDER.HEALTH_BAR_OFFSET_Y;this.ctx.fillStyle="#333",this.ctx.fillRect(n,o,t,i),this.ctx.fillStyle="#ff6b6b",this.ctx.fillRect(n,o,e.health/100*t,i)}renderLoot(e){this.ctx.fillStyle="#f9ca24",this.ctx.fillRect(e.x-5,e.y-5,10,10)}}class c{constructor(){this.inputState={moveX:0,moveY:0,aimX:0,aimY:0,attack:!1,specialAbility:!1,interact:!1},this.keysPressed=new Set,this.boundHandlers={}}init(e){this.onInputChange=e,this.boundHandlers.keydown=this.handleKeyDown.bind(this),this.boundHandlers.keyup=this.handleKeyUp.bind(this),this.boundHandlers.mousemove=this.handleMouseMove.bind(this),this.boundHandlers.mousedown=this.handleMouseDown.bind(this),this.boundHandlers.mouseup=this.handleMouseUp.bind(this),window.addEventListener("keydown",this.boundHandlers.keydown),window.addEventListener("keyup",this.boundHandlers.keyup),window.addEventListener("mousemove",this.boundHandlers.mousemove),window.addEventListener("mousedown",this.boundHandlers.mousedown),window.addEventListener("mouseup",this.boundHandlers.mouseup),console.log("Input initialized")}handleKeyDown(e){const t=e.key.toLowerCase();this.keysPressed.add(t),this.updateMovement(),t===s.INPUT.SPECIAL_ABILITY_KEY?(this.inputState.specialAbility=!0,this.notifyChange()):t===s.INPUT.INTERACT_KEY&&(this.inputState.interact=!0,this.notifyChange())}handleKeyUp(e){const t=e.key.toLowerCase();this.keysPressed.delete(t),this.updateMovement(),t===s.INPUT.SPECIAL_ABILITY_KEY?(this.inputState.specialAbility=!1,this.notifyChange()):t===s.INPUT.INTERACT_KEY&&(this.inputState.interact=!1,this.notifyChange())}updateMovement(){let e=0,t=0;for(const[i,n]of Object.entries(s.INPUT.KEYBOARD_MOVE_KEYS))this.keysPressed.has(i)&&(e+=n.x,t+=n.y);if(e!==0&&t!==0){const i=Math.sqrt(e*e+t*t);e/=i,t/=i}this.inputState.moveX=e,this.inputState.moveY=t,this.notifyChange()}handleMouseMove(e){const t=document.getElementById("game-canvas");if(!t)return;const i=t.getBoundingClientRect();this.inputState.aimX=e.clientX-i.left,this.inputState.aimY=e.clientY-i.top,this.notifyChange()}handleMouseDown(e){e.button===0&&(this.inputState.attack=!0,this.notifyChange())}handleMouseUp(e){e.button===0&&(this.inputState.attack=!1,this.notifyChange())}notifyChange(){this.onInputChange&&this.onInputChange(this.inputState)}destroy(){window.removeEventListener("keydown",this.boundHandlers.keydown),window.removeEventListener("keyup",this.boundHandlers.keyup),window.removeEventListener("mousemove",this.boundHandlers.mousemove),window.removeEventListener("mousedown",this.boundHandlers.mousedown),window.removeEventListener("mouseup",this.boundHandlers.mouseup),console.log("Input destroyed")}}class d{constructor(){this.screens={lobby:null,game:null,gameOver:null}}init(){this.screens.lobby=document.getElementById("lobby-screen"),this.screens.game=document.getElementById("game-screen"),this.screens.gameOver=document.getElementById("game-over-screen"),console.log("UI initialized")}showScreen(e){for(const i of Object.values(this.screens))i&&i.classList.remove("active");const t=this.screens[e];t&&t.classList.add("active")}showJoinCode(e){const t=document.getElementById("join-code-display"),i=document.getElementById("join-code");t&&i&&(i.textContent=e,t.classList.remove("hidden"))}updateHealth(e){const t=document.getElementById("health-bar");t&&(t.style.width=`${e}%`)}updateEquipment(e,t){const i=document.getElementById("equipment-display");if(i){if(i.innerHTML="",e){const n=document.createElement("div");n.className="equipment-slot",n.textContent=`Weapon: ${e.name}`,i.appendChild(n)}if(t){const n=document.createElement("div");n.className="equipment-slot",n.textContent=`Armor: ${t.name}`,i.appendChild(n)}}}showZoneWarning(e){const t=document.getElementById("zone-warning");t&&(e?t.classList.remove("hidden"):t.classList.add("hidden"))}showGameOver(e,t){const i=document.getElementById("game-result"),n=document.getElementById("match-summary");i&&(i.textContent=e),n&&(n.innerHTML=t),this.showScreen("gameOver")}}class u{constructor(){this.game=null,this.renderer=null,this.input=null,this.ui=null,this.lastTimestamp=0,this.running=!1,this.animationFrameId=null}init(){console.log("Initializing Conflict Zone: East vs West"),this.ui=new d,this.ui.init(),this.setupLobbyHandlers()}setupLobbyHandlers(){const e=document.getElementById("host-game-btn"),t=document.getElementById("join-game-btn");e&&e.addEventListener("click",()=>this.hostGame()),t&&t.addEventListener("click",()=>this.joinGame())}hostGame(){console.log("Hosting game..."),this.ui.showJoinCode("DEMO-CODE"),this.startGame()}joinGame(){const e=document.getElementById("join-code-input"),t=e==null?void 0:e.value.trim();if(!t){alert("Please enter a join code");return}if(!/^[A-Z0-9]{6}$/i.test(t)){alert("Please enter a valid 6-character join code (letters and numbers only)");return}console.log("Joining game with code:",t),this.startGame()}startGame(){console.log("Starting game..."),this.ui.showScreen("game");const e=document.getElementById("game-canvas");if(!e){console.error("Canvas element not found");return}this.renderer=new h(e),this.game=new l,this.input=new c,this.renderer.init(),this.game.init(),this.input.init(t=>{this.game&&this.game.handleInput(t)}),this.running=!0,this.lastTimestamp=performance.now(),this.animationFrameId=requestAnimationFrame(t=>this.gameLoop(t))}gameLoop(e){if(!this.running)return;const t=(e-this.lastTimestamp)/1e3;this.lastTimestamp=e,this.game.update(t),this.renderer.render(this.game.getState()),this.animationFrameId=requestAnimationFrame(i=>this.gameLoop(i))}stopGame(){this.running=!1,this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.input&&this.input.destroy()}}document.addEventListener("DOMContentLoaded",()=>{new u().init()});

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frame Sheet Tool</title>
  <script type="module" crossorigin src="../../assets/frameTool-5TR9jn_W.js"></script>
  <link rel="modulepreload" crossorigin href="../../assets/modulepreload-polyfill-B5Qt9EMX.js">
  <link rel="stylesheet" crossorigin href="../../assets/frameTool-BLOU7tZo.css">
</head>
<body class="bg-gray-900 text-gray-200 font-sans m-0 p-2 md:p-5 flex flex-col h-screen box-border overflow-hidden">
    <h1 class="text-xl md:text-2xl font-bold mb-2 md:mb-4">Frame Sheet Tool</h1>
    <div class="flex flex-col md:flex-row flex-1 gap-5 overflow-hidden">
        <div class="w-full md:w-[300px] bg-gray-800 p-3 md:p-5 rounded-lg overflow-y-auto flex flex-col gap-4 shrink-0 shadow-xl">
            <div class="flex flex-col gap-1.5">
                <label for="imageInput" class="text-sm text-gray-400 font-medium">Sprite Sheet Image</label>
                <input type="file" id="imageInput" accept="image/*" class="bg-gray-700 border border-gray-600 text-white p-1.5 rounded text-sm w-full file:mr-4 file:py-1 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-blue-500 file:text-white hover:file:bg-blue-600">
            </div>

            <div class="grid grid-cols-2 md:flex md:flex-col gap-3">
                <div class="flex flex-col gap-1.5">
                    <label for="startX" class="text-sm text-gray-400">Start X</label>
                    <input type="number" id="startX" value="0" class="bg-gray-700 border border-gray-600 text-white p-1.5 rounded">
                </div>
                <div class="flex flex-col gap-1.5">
                    <label for="startY" class="text-sm text-gray-400">Start Y</label>
                    <input type="number" id="startY" value="0" class="bg-gray-700 border border-gray-600 text-white p-1.5 rounded">
                </div>
                <div class="flex flex-col gap-1.5">
                    <label for="frameWidth" class="text-sm text-gray-400">Frame Width</label>
                    <input type="number" id="frameWidth" value="32" class="bg-gray-700 border border-gray-600 text-white p-1.5 rounded">
                </div>
                <div class="flex flex-col gap-1.5">
                    <label for="frameHeight" class="text-sm text-gray-400">Frame Height</label>
                    <input type="number" id="frameHeight" value="32" class="bg-gray-700 border border-gray-600 text-white p-1.5 rounded">
                </div>
                <div class="flex flex-col gap-1.5">
                    <label for="frameCount" class="text-sm text-gray-400">Frame Count</label>
                    <input type="number" id="frameCount" value="4" class="bg-gray-700 border border-gray-600 text-white p-1.5 rounded">
                </div>
                <div class="flex flex-col gap-1.5">
                    <label for="fps" class="text-sm text-gray-400">FPS</label>
                    <input type="number" id="fps" value="10" class="bg-gray-700 border border-gray-600 text-white p-1.5 rounded">
                </div>
            </div>

            <hr class="w-full border-gray-600 my-1 md:my-2">

            <!-- Mobile-specific interaction toggle -->
            <div class="flex flex-col gap-1.5 md:hidden">
                <label for="interactionMode" class="text-sm text-gray-400 font-medium">Touch Interaction Mode</label>
                <select id="interactionMode" class="bg-gray-700 border border-gray-600 text-white p-2 rounded text-sm w-full">
                    <option value="frame">Move Frame (Green Rect)</option>
                    <option value="anchor">Move Anchor (Red Cross)</option>
                </select>
                <p class="text-[10px] text-gray-500 italic">On desktop, use Drag for Frame and Shift+Drag for Anchor.</p>
            </div>

            <div class="mb-1">
                <label class="flex items-center gap-2 cursor-pointer text-sm text-gray-400">
                    <input type="checkbox" id="bgRemoveEnabled" class="w-auto"> 
                    Remove Background
                </label>
            </div>
            <div id="bgRemoveControls" class="hidden flex-col gap-2.5 p-2.5 bg-gray-700/50 rounded border border-gray-600">
                <div class="flex flex-col gap-1.5">
                    <label for="bgKeyColor" class="text-sm text-gray-400">Key Color</label>
                    <div class="flex gap-1.5">
                        <input type="color" id="bgKeyColor" value="#00ff00" class="h-[30px] flex-1 cursor-pointer p-0 bg-transparent border-0">
                        <input type="text" id="bgKeyColorText" value="#00ff00" class="w-[70px] uppercase bg-gray-600 border border-gray-500 text-white p-1 rounded text-center">
                    </div>
                </div>
                <div class="flex flex-col gap-1.5">
                    <label for="bgThreshold" class="text-sm text-gray-400">Tolerance: <span id="bgThresholdVal">0</span></label>
                    <input type="range" id="bgThreshold" min="0" max="255" value="0" step="1" class="w-full">
                </div>
                <div class="flex flex-col gap-1.5">
                    <label for="bgErode" class="text-sm text-gray-400">Erode: <span id="bgErodeVal">0</span> px</label>
                    <input type="range" id="bgErode" min="0" max="5" value="0" step="1" class="w-full">
                </div>
            </div>

            <hr class="w-full border-gray-600 my-1 md:my-2">

            <div class="grid grid-cols-2 md:flex md:flex-col gap-3">
                <div class="flex flex-col gap-1.5">
                    <label for="globalWidth" class="text-sm text-gray-400">Global Width</label>
                    <input type="number" id="globalWidth" value="64" class="bg-gray-700 border border-gray-600 text-white p-1.5 rounded">
                </div>
                <div class="flex flex-col gap-1.5">
                    <label for="globalHeight" class="text-sm text-gray-400">Global Height</label>
                    <input type="number" id="globalHeight" value="64" class="bg-gray-700 border border-gray-600 text-white p-1.5 rounded">
                </div>
            </div>
            
            <button id="exportBtn" class="p-2.5 bg-blue-600 hover:bg-blue-700 text-white font-bold border-none rounded cursor-pointer mt-2 transition-colors shadow-lg">Export Adjusted Sheet</button>

            <div class="flex gap-2 mt-2">
                <button id="saveProjectBtn" class="flex-1 p-2 bg-gray-600 hover:bg-gray-500 text-white border border-gray-500 rounded cursor-pointer text-sm">Save Config</button>
                <label for="loadProjectInput" class="flex-1 p-2 bg-gray-600 hover:bg-gray-500 text-white border border-gray-500 rounded cursor-pointer text-sm text-center">
                    Load Config
                    <input type="file" id="loadProjectInput" accept=".json" class="hidden">
                </label>
            </div>

            <div class="border-t border-gray-600 pt-4 flex flex-col items-center gap-2">
                <label class="text-sm text-gray-400">Preview</label>
                <canvas id="previewCanvas" width="64" height="64" class="self-center mt-2 border border-gray-600 bg-checkerboard"></canvas>
            </div>

            <div class="flex flex-col gap-1.5">
                <label for="jsonOutput" class="text-sm text-gray-400">JSON Configuration</label>
                <textarea id="jsonOutput" readonly class="bg-gray-700 border border-gray-600 text-white p-1.5 rounded font-mono h-[100px] resize-y text-[10px]"></textarea>
            </div>

            <div class="bg-gray-800 p-2.5 rounded text-xs leading-relaxed text-gray-400 flex flex-col gap-1.5 border border-gray-700">
                <label class="text-gray-200 font-bold mb-1 block">Instructions</label>
                <ul class="m-0 pl-4 list-disc space-y-1">
                    <li><strong>Move Frame:</strong> Drag green label.</li>
                    <li><strong>Move Anchor:</strong> Shift + Drag label (Desktop) or toggle mode (Mobile).</li>
                    <li><strong>Set Anchor:</strong> Click/Tap inside a frame.</li>
                    <li><strong>Export:</strong> Aligned strip + JSON.</li>
                </ul>
            </div>
        </div>

        <div class="flex-1 bg-gray-950 rounded-lg relative overflow-auto flex justify-center items-center shadow-inner" id="dropZone">
            <div id="canvasWrapper" class="relative inline-block m-10">
                <canvas id="mainCanvas" class="border border-gray-700 bg-checkerboard shadow-2xl"></canvas>
                <div id="overlayLayer" class="absolute top-0 left-0 w-full h-full pointer-events-none"></div>
            </div>
        </div>
    </div>

</body>
</html>